

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scikit-qulacs チュートリアル &#8212; scikit-qulacs  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/0_tutorial';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Circuit visualize" href="circuit_visualize.html" />
    <link rel="prev" title="Notebooks" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">scikit-qulacs  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">skqulacs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../skqulacs.html">skqulacs package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../skqulacs.circuit.html">skqulacs.circuit package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.circuit.circuit.html">skqulacs.circuit.circuit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.circuit.pre_defined.html">skqulacs.circuit.pre_defined module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../skqulacs.qkrr.html">skqulacs.qkrr package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qkrr.qkrr.html">skqulacs.qkrr.qkrr module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../skqulacs.qnn.html">skqulacs.qnn package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qnn.classifier.html">skqulacs.qnn.classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qnn.generation.html">skqulacs.qnn.generation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qnn.regressor.html">skqulacs.qnn.regressor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qnn.solver.html">skqulacs.qnn.solver module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../skqulacs.qsvm.html">skqulacs.qsvm package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qsvm.qsvc.html">skqulacs.qsvm.qsvc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../skqulacs.qsvm.qsvr.html">skqulacs.qsvm.qsvr module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../skqulacs.dataloader.html">skqulacs.dataloader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../skqulacs.save.html">skqulacs.save module</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Notebooks</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">scikit-qulacs チュートリアル</a></li>
<li class="toctree-l2"><a class="reference internal" href="circuit_visualize.html">Circuit visualize</a></li>
<li class="toctree-l2"><a class="reference internal" href="dqn_cl.html">Toward Trainability of Deep Quantum Neural Networks</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="paper_reproduction.html">Reproducing papers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="arxiv_2108_01039_large_scale_quantum_machine_learning.html">Reproducing arXiv:2108.01039 with scikit-qulacs</a></li>
<li class="toctree-l3"><a class="reference internal" href="qcnn.html">Quantum Convolutional Neural Network with scikit-qulacs</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/Qulacs-Osaka/scikit-qulacs/blob/main/doc/source/notebooks/0_tutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/Qulacs-Osaka/scikit-qulacs" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/0_tutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>scikit-qulacs チュートリアル</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">scikit-qulacs とは</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">インストール</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-neural-network">Quantum neural network</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-qnnclassifier"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNClassifier</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-qnnregressor"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNRegressor</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-generation"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.generation</span></code> の使い方</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">量子カーネル法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qsvm-qsvc"><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVC</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qsvm-qsvr"><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVR</span></code> の使い方</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">用意されている量子回路</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">ユーザー定義の量子回路を学習に利用する</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="scikit-qulacs">
<h1>scikit-qulacs チュートリアル<a class="headerlink" href="#scikit-qulacs" title="Permalink to this heading">#</a></h1>
<section id="id1">
<h2>scikit-qulacs とは<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>量子回路シミュレータ <a class="reference external" href="https://github.com/Qulacs-Osaka/qulacs-osaka">Qulacs-Osaka</a> (<a class="reference external" href="https://github.com/qulacs/qulacs">Qulacs</a> の大阪大学バージョン) をバックエンドとした量子機械学習アルゴリズムのシミュレータです。scikit-learn の名前をもじっています。</p>
</section>
<section id="id2">
<h2>インストール<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>PyPI からインストールできます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">skqulacs</span>
</pre></div>
</div>
<p>※Python 3.8以降を使用してください。Python 3.7系の場合、PyPIインストールで旧版0.2.0がインストールされます。最新コードで実装されているチュートリアルがエラーになる場合があります。</p>
</section>
<section id="quantum-neural-network">
<h2>Quantum neural network<a class="headerlink" href="#quantum-neural-network" title="Permalink to this heading">#</a></h2>
<p>入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> に対して、学習パラメータ <span class="math notranslate nohighlight">\({\boldsymbol \theta}\)</span> を使って
<div class="math notranslate nohighlight">
\[y_{{\boldsymbol \theta}}({\boldsymbol x}) = \langle 0|U^\dagger({\boldsymbol \theta}, {\boldsymbol x}) O U({\boldsymbol \theta}, {\boldsymbol x})|0\rangle\]</div>

の形でモデル <span class="math notranslate nohighlight">\(y_{{\boldsymbol \theta}}({\boldsymbol x})\)</span> を構築する手法を量子ニューラルネットワークと呼びます。scikit-qulacs では <code class="docutils literal notranslate"><span class="pre">skqulacs.qnn</span></code> モジュールに実装されています。分類問題をとく <code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.classifier</span></code> と回帰問題を解く <code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.regressor</span></code> の２つがあります。</p>
<section id="skqulacs-qnn-qnnclassifier">
<h3><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNClassifier</span></code> の使い方<a class="headerlink" href="#skqulacs-qnn-qnnclassifier" title="Permalink to this heading">#</a></h3>
<p>例として、有名な <code class="docutils literal notranslate"><span class="pre">iris</span></code> データセットを分類する量子ニューラルネットワークを組んでみます。まず、以下のコードによって <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> から <code class="docutils literal notranslate"><span class="pre">iris</span></code> データセットを取り出し、訓練データとテストデータに分けます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;petal length (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;petal width (cm)&quot;</span><span class="p">]]</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>変数はそれぞれ</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x_train</span></code>: 訓練データの入力</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_train</span></code>: 訓練データのラベル</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_test</span></code>: テストデータの入力</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_test</span></code>: テストデータのラベル</p></li>
</ul>
<p>です。</p>
<p>次に簡単な量子回路によってこれらの分類を行ってみます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.circuit.pre_defined</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_qcl_ansatz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNNClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qnn.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bfgs</span>

<span class="n">nqubit</span> <span class="o">=</span> <span class="mi">5</span>                      <span class="c1"># qubitの数。必要とする入力、出力の次元数以上が必要である。</span>
<span class="n">c_depth</span> <span class="o">=</span> <span class="mi">3</span>                     <span class="c1"># circuitの深さ。ニューラルネットワークでの隠れ層に対応する。</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">1.</span>                  <span class="c1"># qcl_ansatz に必要となるパラメータ。横磁場イジングモデルによって発展させる時間を決める。</span>
<span class="n">num_class</span> <span class="o">=</span> <span class="mi">3</span>                   <span class="c1"># 分類数（ここでは3つの品種に分類）</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Bfgs</span><span class="p">()</span>                   <span class="c1"># アルゴリズム。ほかには、`Adam()` や `NelderMead()` が使える。</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="mi">20</span>                    <span class="c1"># ループの最大。これが多いほど、正確になるが、時間がかかる。</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">create_qcl_ansatz</span><span class="p">(</span><span class="n">nqubit</span><span class="p">,</span> <span class="n">c_depth</span><span class="p">,</span> <span class="n">time_step</span><span class="p">)</span>     <span class="c1"># LearningCircuitを作る</span>
<span class="n">qcl</span> <span class="o">=</span> <span class="n">QNNClassifier</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span>     <span class="c1"># モデル構築を行う</span>
<span class="n">opt_loss</span><span class="p">,</span> <span class="n">opt_params</span> <span class="o">=</span> <span class="n">qcl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">)</span>                          <span class="c1"># 学習</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trained parameters&quot;</span><span class="p">,</span> <span class="n">opt_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="n">opt_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>trained parameters [ 3.3077862   2.20610834  0.18317852  2.57427866  2.1731261   5.16437333
  6.90379975  4.92301026  3.78621276  5.01264629  5.39612169  5.06373429
  2.36012806  4.08739844  5.47151574  2.70898056  3.1735183   2.66824882
  0.2683309   4.5094121   6.64751394 -0.05754961  6.58882916  4.47236961
  1.6969534   6.44925444  0.82493735  5.89706655  0.36732051  4.13386748
  5.63948049  2.33409167  4.17240084  0.31197252  2.18623163  0.46591338
  0.45247138  4.11809259  0.99494374  4.61047697  6.022204    3.2083882
  1.44504131  2.8614801   5.06963927]
loss 0.3253091864984035
</pre></div>
</div>
</div>
</div>
<p>テストデータと比べて結果を出力します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">f1_score</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">qcl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9473684210526315
</pre></div>
</div>
</div>
</div>
<p>うまく分類できていることがわかります。</p>
</section>
<section id="skqulacs-qnn-qnnregressor">
<h3><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNRegressor</span></code> の使い方<a class="headerlink" href="#skqulacs-qnn-qnnregressor" title="Permalink to this heading">#</a></h3>
<p>回帰問題を解くには <code class="docutils literal notranslate"><span class="pre">QNNRegressor</span></code> を使います。ここでは <span class="math notranslate nohighlight">\(y=\sin(\pi x)\)</span> を学習させてみます。まずデータセットを作ります。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_rng</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_noisy_sine</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_x</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x_train</span> <span class="o">=</span> <span class="p">[[</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">)]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_train</span><span class="p">]</span>
    <span class="n">mag_noise</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">y_train</span> <span class="o">+=</span> <span class="n">mag_noise</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">num_x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
  
<span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">num_x</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">generate_noisy_sine</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_x</span><span class="p">)</span>
<span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">generate_noisy_sine</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>作成したデータに対して学習を行います。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNNRegressor</span>

<span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Bfgs</span><span class="p">()</span>
<span class="n">maxiter</span><span class="o">=</span> <span class="mi">30</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">create_qcl_ansatz</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">qnn</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span>
<span class="n">opt_loss</span><span class="p">,</span> <span class="n">opt_params</span> <span class="o">=</span> <span class="n">qnn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trained parameters&quot;</span><span class="p">,</span> <span class="n">opt_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="n">opt_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>trained parameters [ 4.25798056  1.92999783  0.31115392  0.49212499  4.80907853  6.06343962
  4.00173116  4.9030698   3.43327385  5.81135678  5.07675043  0.49105851
  5.42057489 -0.14168464  4.58566892  1.36858878  5.36424976  3.55819331
  1.73062387  2.57575324  0.13021265  1.13880549  4.24069209  3.98487665
  3.57694613  2.3916734   6.35641985  6.29467416  4.37029016  4.04927805
  4.49274116  2.73557408  0.63853703  4.45377244  3.03068676  2.05579799
  3.04866402  5.44965241  5.85460933  2.23874886  3.3939702   2.04538289
  3.79038304  1.9171457   2.36846662  5.80016494  1.49691542  4.21257824
  0.37117935  5.12489574  4.95969291  1.41616941  5.50035696  0.29056759
  2.13739014  0.89954726  2.93673013  5.33719954  1.33472466  0.45390472
  2.59255057  1.20163753  0.38793178  3.64633592  1.87676315  4.22226834
  1.25359251  5.91947125  2.29405484  0.66284639  3.95280309  5.82548387]
loss 0.001734007213230344
</pre></div>
</div>
</div>
</div>
<p>訓練したモデルとテストデータを並べてプロットしてみます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">qnn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prediction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/46b5b48546faa84faaf45862bc9e3690f3ca4a5d2c4d2616d5207210ef04c401.png" src="../_images/46b5b48546faa84faaf45862bc9e3690f3ca4a5d2c4d2616d5207210ef04c401.png" />
</div>
</div>
<p>よく学習できていることがわかります。</p>
</section>
<section id="skqulacs-qnn-generation">
<h3><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.generation</span></code> の使い方<a class="headerlink" href="#skqulacs-qnn-generation" title="Permalink to this heading">#</a></h3>
<p>生成モデルを作ります。
生成モデルとは、教師なし学習の一種で、入力データの分布を学習し、それに応じた新しいサンプルを生成するモデルです。</p>
<p>ここでは、例として、ガウス関数の和のモデルを学習させてみます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">exp</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_farhi_neven_ansatz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNNGeneretor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qnn.solver</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bfgs</span>
<span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">create_farhi_neven_ansatz</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>

<span class="n">qnn</span> <span class="o">=</span> <span class="n">QNNGeneretor</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">Bfgs</span><span class="p">(),</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1">#prob_listつまり、確率分布を生成する</span>
<span class="n">prob_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="n">ua</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">7</span>
<span class="n">ub</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">7</span>
<span class="n">v</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span>
<span class="n">prob_sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
    <span class="n">prob_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">ua</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ua</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span><span class="p">))</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
        <span class="o">-</span><span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">prob_sum</span> <span class="o">+=</span> <span class="n">prob_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>
    <span class="n">prob_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">prob_sum</span>

<span class="c1">#prob_list が、理想的な確率分布になる。</span>

<span class="c1">#prob_listの確率分布をもとに、10000個のデータを作る</span>
<span class="n">datas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">prob_list</span><span class="p">)</span>


<span class="n">maxiter</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">qnn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">datas</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">)</span>

<span class="n">data_param</span> <span class="o">=</span> <span class="n">qnn</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/watle/pros/scikit-qulacs/.venv/lib/python3.8/site-packages/scipy/optimize/linesearch.py:167: ComplexWarning: Casting complex values to real discards the imaginary part
  stp, phi1, derphi1, task = minpack2.dcsrch(alpha1, phi1, derphi1,
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="p">)),</span> <span class="n">data_param</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="p">)),</span> <span class="n">prob_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/watle/pros/scikit-qulacs/.venv/lib/python3.8/site-packages/matplotlib/cbook/__init__.py:1298: ComplexWarning: Casting complex values to real discards the imaginary part
  return np.asarray(x, float)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fec5fd9fd60&gt;]
</pre></div>
</div>
<img alt="../_images/c9df8c4e05899daf09da435523cac1056e1d4dfefc75c27ee996fc2729d4ff4f.png" src="../_images/c9df8c4e05899daf09da435523cac1056e1d4dfefc75c27ee996fc2729d4ff4f.png" />
</div>
</div>
<p>オレンジが学習すべきものの頻度の折れ線グラフ、
青が学習した頻度の折れ線グラフです。</p>
<p>うまく学習できています。</p>
</section>
</section>
<section id="id3">
<h2>量子カーネル法<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> を量子状態 <span class="math notranslate nohighlight">\(|\psi({\boldsymbol x})\rangle\)</span> にマップし、この量子状態間の内積で定義されるカーネル関数
<div class="math notranslate nohighlight">
\[K({\boldsymbol x},{\boldsymbol x}')=|\langle \psi({\boldsymbol x})| \psi({\boldsymbol x}')\rangle|^2\]</div>

を使ったカーネル法を量子カーネル法と呼びます。scikit-qulacs には、support vector classifier <code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVC</span></code> と support vector regressor <code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVR</span></code> の2つが実装されています。</p>
<section id="skqulacs-qsvm-qsvc">
<h3><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVC</span></code> の使い方<a class="headerlink" href="#skqulacs-qsvm-qsvc" title="Permalink to this heading">#</a></h3>
<p>ここでは IBM のグループが論文 <a class="reference external" href="https://www.nature.com/articles/s41586-019-0980-2">Supervised learning with quantum-enhanced feature spaces</a> で提案した <span class="math notranslate nohighlight">\(|\psi({\boldsymbol x})\rangle\)</span> を使った分類を行います。この状態を作る量子回路は <code class="docutils literal notranslate"><span class="pre">skqulacs.circuit.create_ibm_embedding_circuit</span></code> によって作り出せます。</p>
<p>まずデータセットを準備します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;petal length (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;petal width (cm)&quot;</span><span class="p">]]</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>回路を作成し、QSVC を訓練、予測値を出力させます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_ibm_embedding_circuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qsvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">QSVC</span>
<span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">4</span>                         <span class="c1"># x_train の次元数以上必要。あまり小さいと結果が悪くなる。</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">create_ibm_embedding_circuit</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">)</span>
<span class="n">qsvm</span> <span class="o">=</span> <span class="n">QSVC</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
<span class="n">qsvm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">qsvm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>評価してみます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8978070175438595
</pre></div>
</div>
</div>
</div>
<p>qnn よりも悪い結果となりました。回路形がこのデータセットに適していないからだと考えられます。</p>
</section>
<section id="skqulacs-qsvm-qsvr">
<h3><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVR</span></code> の使い方<a class="headerlink" href="#skqulacs-qsvm-qsvr" title="Permalink to this heading">#</a></h3>
<p>同様の回路を使い、回帰を行ってみます。QNN の場合と同様に、<span class="math notranslate nohighlight">\(\sin(\pi x)\)</span> を学習します。まずデータセットを作ります。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">num_x</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">generate_noisy_sine</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_x</span><span class="p">)</span>
<span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">generate_noisy_sine</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>学習します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.qsvm</span><span class="w"> </span><span class="kn">import</span> <span class="n">QSVR</span>
<span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">4</span>                         <span class="c1"># x_train の次元数以上必要。あまり小さいと結果が悪くなる。</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">create_ibm_embedding_circuit</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">)</span>
<span class="n">qsvm</span> <span class="o">=</span> <span class="n">QSVR</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
<span class="n">qsvm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">qsvm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>学習結果をプロットしてみます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prediction&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/880ffe114c99d4dd4e5a10f6391db33d20912414da61c5b2dcf47667f01ed7b2.png" src="../_images/880ffe114c99d4dd4e5a10f6391db33d20912414da61c5b2dcf47667f01ed7b2.png" />
</div>
</div>
<p>うまく学習できています。</p>
</section>
</section>
<section id="id4">
<h2>用意されている量子回路<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<p>scikit-qulacs では代表的な論文で発表されている機械学習用量子回路を手軽に使えるようにするため、量子回路の実装に努めています。機械学習用量子回路は <code class="docutils literal notranslate"><span class="pre">LearningCircuit</span></code> クラスのインスタンスとして実装されていて、<code class="docutils literal notranslate"><span class="pre">skqulacs.circuit</span></code> モジュールにある <code class="docutils literal notranslate"><span class="pre">create_...()</span></code> という関数を呼ぶことにより作成可能です。</p>
<p>代表的なansatzとして、</p>
<ul class="simple">
<li><p>create_farhi_neven_ansatz(n_qubit: int, c_depth: int, seed: Optional[int] = None): <a class="reference external" href="https://arxiv.org/pdf/1802.06002">arXiv:1802.06002</a>
<img alt="farhi_neven_ansatz" src="../_images/farhi_neven_ansatz.png" /></p></li>
<li><p>create_ibm_embedding_circuit(n_qubit: int): <a class="reference external" href="https://arxiv.org/abs/1804.11326">arXiv:1804.11326</a>
<img alt="ibm_embedding_circuit" src="../_images/ibm_embedding_circuit.png" /></p></li>
</ul>
<p>が用意されています。</p>
<p>他に利用可能な量子回路のリストについては<a class="reference internal" href="circuit_visualize.html"><span class="doc std std-doc">このページ</span></a>をご覧ください。</p>
<p>基本的には <code class="docutils literal notranslate"><span class="pre">QNNClassifier</span></code> などの引数として与えることを推奨しますが、自前で新たなアルゴリズムを作りたいときなど、これらの量子回路を直接扱いたいときもあると思います。以下に使用例を掲載します。</p>
<p>以下のコードで QCL ansatz を作成します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">c_depth</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">create_qcl_ansatz</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">c_depth</span><span class="p">,</span> <span class="n">time_step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">LearningCircuit</span></code> にセットされている訓練パラメータは <code class="docutils literal notranslate"><span class="pre">get_parameters()</span></code> によって取り出せます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">),</span> <span class="n">parameters</span><span class="p">)</span>      <span class="c1"># show parameters in the circuit. Parameters are chosen randomly within create_qcl_ansatz()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48 [2.9646519753472966, 2.4054163630603496, 5.8984153363073375, 2.512801032804015, 5.964913519260788, 3.8936080016830195, 5.923572589632018, 4.9481732525951205, 1.568563629432675, 5.554018967676112, 0.028389796241806445, 2.897527605841249, 5.267355240624224, 3.735313799160573, 2.2661746616128897, 3.5452804132198086, 0.43246053635497056, 2.5730108963703193, 1.974663878510053, 1.9654655970918322, 3.967587987184092, 0.8120259125764905, 6.047592885353966, 0.5745413307337336, 0.9710274726615847, 0.4695106940105736, 2.341674095381348, 0.802699963876766, 0.8310916316734924, 5.012384620423008, 0.018233484756863608, 4.2472370241118345, 5.1721310224316355, 5.021016841850289, 3.1032612340282735, 6.090572550277523, 4.484895234385721, 2.0890853870812838, 1.8127693347262788, 3.7158089135425, 3.7028938225792483, 3.3726572966673407, 2.699611657167366, 1.6621937249934382, 1.1061035348895243, 1.5957931515488104, 0.26282289161037825, 2.4484720212561286]
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">update_parameters()</span></code> を使うと、パラメータを更新できます。以下では全てのパラメータをゼロにセットします。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ansatz</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">run(x)</span></code> を使うと、入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> に対して、初期状態 <span class="math notranslate nohighlight">\(|0\rangle\)</span> に量子回路を作用させたときの出力状態が <code class="docutils literal notranslate"><span class="pre">qulacs.QuantumState</span></code> として返されます。QCL ansatz は <code class="docutils literal notranslate"><span class="pre">n_qubits</span></code> 次元までの入力を扱うことのできる ansatz なので、今回は 2 次元入力を与えます。</p>
<p>多くの回路では、データ次元数をaとして、それが<code class="docutils literal notranslate"><span class="pre">n_qubits</span></code>以下の場合、回路のx番目には、n_qubits % a 番目の入力が入ります。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get_vector</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.30869612+0.13283004j -0.0759879 -0.06176279j -0.21316566-0.1438611j
  0.21877642+0.06614673j -0.33638863+0.12504632j  0.24610584+0.23178805j
  0.05948781+0.05711437j  0.03556247-0.08914448j  0.03556247-0.08914448j
  0.05948781+0.05711437j  0.24610584+0.23178805j -0.33638863+0.12504632j
  0.21877642+0.06614673j -0.21316566-0.1438611j  -0.0759879 -0.06176279j
  0.30869612+0.13283004j]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2>ユーザー定義の量子回路を学習に利用する<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<p>ここでは自分でオリジナルの量子回路を定義し、それを学習に利用する方法を説明します。scikit-qulacs では、<code class="docutils literal notranslate"><span class="pre">LearningCircuit</span></code> クラスによって量子回路を表現しています。これは qulacs の <code class="docutils literal notranslate"><span class="pre">ParametricQuantumCircuit</span></code> のラッパーとなっていて、入力データと訓練される回路パラメータを一元管理し、それらをすべて qulacs の parametric gate で扱えるようにしたものです。</p>
<p><code class="docutils literal notranslate"><span class="pre">LearningCircuit</span></code> クラスは qulacs の <code class="docutils literal notranslate"><span class="pre">ParametricQuantumCircuit</span></code> のうちの主要な <code class="docutils literal notranslate"><span class="pre">add_.._gate()</span></code> 系のメソッドを機能そのままにラップしています。それに加えて、<code class="docutils literal notranslate"><span class="pre">ParametricQuantumCircuit</span></code> を拡張する機能として、以下のメソッドが追加されています。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">add_input_RX_gate(index,</span> <span class="pre">input_func)</span></code>, <code class="docutils literal notranslate"><span class="pre">add_input_RY_gate(index,</span> <span class="pre">input_func)</span></code>, <code class="docutils literal notranslate"><span class="pre">add_input_RZ_gate(index,</span> <span class="pre">input_func)</span></code>: 入力データを入れるためのゲートを追加します。引数にはそれぞれ以下のものを与えます。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: そのゲートを作用させる量子ビット</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_func</span></code>: 入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> -&gt; 回転ゲートの回転角 <span class="math notranslate nohighlight">\(\phi = \phi({\boldsymbol x})\)</span> の変換を行う関数。回路実行時には <code class="docutils literal notranslate"><span class="pre">input_func(x)</span></code> が角度にセットされます。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_parametric_input_RX_gate(index,</span> <span class="pre">parameter,</span> <span class="pre">input_func)</span></code> (RY, RZ も同様) :入力データと訓練パラメータが同時に含まれているようなゲートを追加します。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: そのゲートを作用させる量子ビット</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code>: 実数の訓練パラメータ <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_func</span></code>: 入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span>, 訓練パラメータ <span class="math notranslate nohighlight">\(\theta\)</span> -&gt; 回転ゲートの回転角 <span class="math notranslate nohighlight">\(\phi = \phi(\theta, {\boldsymbol x})\)</span> の変換を行う関数。回路実行時には <code class="docutils literal notranslate"><span class="pre">input_func(theta,</span> <span class="pre">x)</span></code> が角度にセットされます。</p></li>
</ul>
</li>
</ul>
<p>例えば以下のコードは、各量子ビットに <span class="math notranslate nohighlight">\({\boldsymbol x} = \{x_i\}_{i=0}^3\)</span> の各成分を <span class="math notranslate nohighlight">\(R_y\)</span> ゲートで入力したあと、各量子ビットを訓練可能な <span class="math notranslate nohighlight">\(R_y\)</span> ゲートで変換し、最後に全ての量子ビットにアダマールゲートを一度だけ作用させる <code class="docutils literal notranslate"><span class="pre">LearningCircuit</span></code> を構成するコードです。(例のためだけに書いていて、特に意味は無い回路です。)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">skqulacs.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">LearningCircuit</span>
<span class="n">n_qubit</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">LearningCircuit</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">):</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">add_input_RY_gate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="k">2</span>])  # input 2 dimensional x into the circuit by RY rotation
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">):</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">add_parametric_RY_gate</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>           <span class="c1"># first argument is qubit index, second argument is parameter</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubit</span><span class="p">):</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">add_H_gate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">run()</span></code> メソッドによって初期状態 <span class="math notranslate nohighlight">\(|0\rangle\)</span> にこの回路を作用させたときの量子状態が返されます。このメソッドは入力データ <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> を引数として取ります。上の回路は 2 次元の <span class="math notranslate nohighlight">\({\boldsymbol x}\)</span> を取れるように設計したので、2次元の入力を与えます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get_vector</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-6.93889390e-18+0.j -1.96261557e-17+0.j -2.08166817e-17+0.j
 -2.77555756e-17+0.j -2.08166817e-17+0.j  1.96261557e-17+0.j
 -6.93889390e-18+0.j  0.00000000e+00+0.j -2.08166817e-17+0.j
  1.96261557e-17+0.j -6.93889390e-18+0.j  2.77555756e-17+0.j
 -6.93889390e-18+0.j  5.88784672e-17+0.j  9.02056208e-17+0.j
  1.00000000e+00+0.j]
</pre></div>
</div>
</div>
</div>
<p>予想どおりの出力が得られることが確認できます。</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="circuit_visualize.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Circuit visualize</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">scikit-qulacs とは</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">インストール</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-neural-network">Quantum neural network</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-qnnclassifier"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNClassifier</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-qnnregressor"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.QNNRegressor</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qnn-generation"><code class="docutils literal notranslate"><span class="pre">skqulacs.qnn.generation</span></code> の使い方</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">量子カーネル法</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qsvm-qsvc"><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVC</span></code> の使い方</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#skqulacs-qsvm-qsvr"><code class="docutils literal notranslate"><span class="pre">skqulacs.qsvm.QSVR</span></code> の使い方</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">用意されている量子回路</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">ユーザー定義の量子回路を学習に利用する</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Qulacs-Osaka
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021, Qulacs-Osaka.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>