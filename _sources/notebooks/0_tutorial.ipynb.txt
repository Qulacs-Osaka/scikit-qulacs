{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# scikit-qulacs チュートリアル\n",
    "\n",
    "## scikit-qulacs とは \n",
    "\n",
    "量子回路シミュレータ [Qulacs-Osaka](https://github.com/Qulacs-Osaka/qulacs-osaka) ([Qulacs](https://github.com/qulacs/qulacs) の大阪大学バージョン) をバックエンドとした量子機械学習アルゴリズムのシミュレータです。scikit-learn の名前をもじっています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## インストール\n",
    "PyPI からインストールできます。\n",
    "```\n",
    "pip install skqulacs\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Quantum neural network\n",
    "入力データ ${\\boldsymbol x}$ に対して、学習パラメータ ${\\boldsymbol \\theta}$ を使って\n",
    "$$y_{{\\boldsymbol \\theta}}({\\boldsymbol x}) = \\langle 0|U^\\dagger({\\boldsymbol \\theta}, {\\boldsymbol x}) O U({\\boldsymbol \\theta}, {\\boldsymbol x})|0\\rangle$$\n",
    "の形でモデル $y_{{\\boldsymbol \\theta}}({\\boldsymbol x})$ を構築する手法を量子ニューラルネットワークと呼びます。scikit-qulacs では `skqulacs.qnn` モジュールに実装されています。分類問題をとく `skqulacs.qnn.classifier` と回帰問題を解く `skqulacs.qnn.regressor` の２つがあります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qnn.QNNClassifier` の使い方\n",
    "例として、有名な `iris` データセットを分類する量子ニューラルネットワークを組んでみます。まず、以下のコードによって `scikit-learn` から `iris` データセットを取り出し、訓練データとテストデータに分けます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from sklearn import datasets\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "iris = datasets.load_iris()\n",
    "df = pd.DataFrame(iris.data, columns=iris.feature_names)\n",
    "x = df.loc[:, [\"petal length (cm)\", \"petal width (cm)\"]]\n",
    "x_train, x_test, y_train, y_test = train_test_split(\n",
    "    x, iris.target, test_size=0.25, random_state=0\n",
    ")\n",
    "x_train = x_train.to_numpy()\n",
    "x_test = x_test.to_numpy()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "変数はそれぞれ\n",
    "- `x_train`: 訓練データの入力\n",
    "- `y_train`: 訓練データのラベル\n",
    "- `x_test`: テストデータの入力\n",
    "- `y_test`: テストデータのラベル\n",
    "\n",
    "です。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "次に簡単な量子回路によってこれらの分類を行ってみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trained parameters [0.97300102 4.7946057  1.35324745 4.60159679 0.84295957 5.56893232\n",
      " 2.97127584 3.52436879 2.66614812 3.95883123 5.70926506 1.43514818\n",
      " 1.30129673 4.21197406 0.11398426 3.88219833 3.42516568 4.40926617\n",
      " 3.12730264 6.37394772 4.07034292 0.89179287 4.3552535  1.66574795\n",
      " 5.21039097 0.71562215 3.10967854 3.05110192 3.20220236 4.85778961\n",
      " 3.30073192 4.73812554 5.19581744 2.3490641  5.56608874 4.56623562\n",
      " 1.50201101 2.46122035 0.33688698 3.34948834 1.21640588 2.56967473\n",
      " 0.71806182 2.1133044  0.58354405]\n",
      "loss 0.32948758938501604\n"
     ]
    }
   ],
   "source": [
    "from skqulacs.circuit.pre_defined import create_qcl_ansatz\n",
    "from skqulacs.qnn import QNNClassifier\n",
    "from skqulacs.qnn.solver import Bfgs\n",
    "\n",
    "nqubit = 5                      # qubitの数。必要とする入力、出力の次元数以上が必要である。\n",
    "c_depth = 3                     # circuitの深さ。ニューラルネットワークでの隠れ層に対応する。\n",
    "time_step = 1.                  # qcl_ansatz に必要となるパラメータ。横磁場イジングモデルによって発展させる時間を決める。\n",
    "num_class = 3                   # 分類数（ここでは3つの品種に分類）\n",
    "solver = Bfgs()                   # アルゴリズム。ほかには、`Adam()` や `NelderMead()` が使える。\n",
    "maxiter = 20                    # ループの最大。これが多いほど、正確になるが、時間がかかる。\n",
    "circuit = create_qcl_ansatz(nqubit, c_depth, time_step)     # LearningCircuitを作る\n",
    "qcl = QNNClassifier(circuit, num_class, solver)     # モデル構築を行う\n",
    "opt_loss, opt_params = qcl.fit(x_train, y_train, maxiter)                          # 学習\n",
    "print(\"trained parameters\", opt_params)\n",
    "print(\"loss\", opt_loss)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "テストデータと比べて結果を出力します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.9739522830846216\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import f1_score\n",
    "y_pred = qcl.predict(x_test)\n",
    "print(f1_score(y_test, y_pred, average=\"weighted\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "うまく分類できていることがわかります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qnn.QNNRegressor` の使い方\n",
    "回帰問題を解くには `QNNRegressor` を使います。ここでは $y=\\sin(\\pi x)$ を学習させてみます。まずデータセットを作ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from numpy.random import default_rng\n",
    "\n",
    "def generate_noisy_sine(x_min, x_max, num_x):\n",
    "    rng = default_rng(0)\n",
    "    x_train = [[rng.uniform(x_min, x_max)] for _ in range(num_x)]\n",
    "    y_train = [np.sin(np.pi*x[0]) for x in x_train]\n",
    "    mag_noise = 0.01\n",
    "    y_train += mag_noise * rng.random(num_x)\n",
    "    return np.array(x_train), np.array(y_train)\n",
    "  \n",
    "x_min = -1.0\n",
    "x_max = 1.0\n",
    "num_x = 80\n",
    "x_train, y_train = generate_noisy_sine(x_min, x_max, num_x)\n",
    "x_test, y_test = generate_noisy_sine(x_min, x_max, num_x)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "作成したデータに対して学習を行います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trained parameters [ 4.80281211  1.93928838 -0.5205007   0.36683164  4.82276275  6.47811525\n",
      "  3.38919905  5.02087438  3.3718359   6.32019833  5.49131488  0.14543509\n",
      "  5.4754958   0.66461726  4.68233889  1.42410867  5.53990554  3.79548094\n",
      "  1.84638698  2.68947621  0.03457702  0.94699584  4.49461489  3.60827377\n",
      "  3.89882872  2.59470479  6.22981776  6.1633591   4.24396167  3.91849499\n",
      "  4.33407504  2.57338267  0.69187344  4.87367468  3.40637054  1.60695639\n",
      "  3.30741867  5.46553484  5.94186833  2.24809352  3.59102784  2.02236503\n",
      "  3.73409722  2.12315885  2.46061475  5.59375873  1.42727325  3.91560031]\n",
      "loss 0.00850908606711705\n"
     ]
    }
   ],
   "source": [
    "from skqulacs.qnn import QNNRegressor\n",
    "\n",
    "n_qubit = 4\n",
    "depth = 4\n",
    "time_step = 0.5\n",
    "solver = Bfgs()\n",
    "maxiter=20\n",
    "circuit = create_qcl_ansatz(n_qubit, depth, time_step, 0)\n",
    "qnn = QNNRegressor(circuit, solver)\n",
    "opt_loss, opt_params = qnn.fit(x_train, y_train, maxiter)\n",
    "print(\"trained parameters\", opt_params)\n",
    "print(\"loss\", opt_loss)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "訓練したモデルとテストデータを並べてプロットしてみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "y_pred = qnn.predict(x_test)\n",
    "plt.plot(x_test, y_test, \"o\", label=\"Test\")\n",
    "plt.plot(np.sort(np.array(x_test).flatten()), np.array(y_pred)[np.argsort(np.array(x_test).flatten())], label=\"Prediction\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "よく学習できていることがわかります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 量子カーネル法\n",
    "入力データ ${\\boldsymbol x}$ を量子状態 $|\\psi({\\boldsymbol x})\\rangle$ にマップし、この量子状態間の内積で定義されるカーネル関数\n",
    "$$K({\\boldsymbol x},{\\boldsymbol x}')=|\\langle \\psi({\\boldsymbol x})| \\psi({\\boldsymbol x}')\\rangle|^2$$\n",
    "を使ったカーネル法を量子カーネル法と呼びます。scikit-qulacs には、support vector classifier `skqulacs.qsvm.QSVC` と support vector regressor `skqulacs.qsvm.QSVR` の2つが実装されています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qsvm.QSVC` の使い方\n",
    "ここでは IBM のグループが論文 [Supervised learning with quantum-enhanced feature spaces](https://www.nature.com/articles/s41586-019-0980-2) で提案した $|\\psi({\\boldsymbol x})\\rangle$ を使った分類を行います。この状態を作る量子回路は `skqulacs.circuit.create_ibm_embedding_circuit` によって作り出せます。\n",
    "\n",
    "まずデータセットを準備します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "iris = datasets.load_iris()\n",
    "df = pd.DataFrame(iris.data, columns=iris.feature_names)\n",
    "x = df.loc[:, [\"petal length (cm)\", \"petal width (cm)\"]]\n",
    "x_train, x_test, y_train, y_test = train_test_split(\n",
    "    x, iris.target, test_size=0.25, random_state=0\n",
    ")\n",
    "x_train = x_train.to_numpy()\n",
    "x_test = x_test.to_numpy()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "回路を作成し、QSVC を訓練、予測値を出力させます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.circuit import create_ibm_embedding_circuit\n",
    "from skqulacs.qsvm import QSVC\n",
    "n_qubit = 4                         # x_train の次元数以上必要。あまり小さいと結果が悪くなる。\n",
    "circuit = create_ibm_embedding_circuit(n_qubit)\n",
    "qsvm = QSVC(circuit)\n",
    "qsvm.fit(x_train, y_train)\n",
    "y_pred = qsvm.predict(x_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "評価してみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.8978070175438595\n"
     ]
    }
   ],
   "source": [
    "print(f1_score(y_test, y_pred, average=\"weighted\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "qnn よりも悪い結果となりました。回路形がこのデータセットに適していないからだと考えられます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qsvm.QSVR` の使い方\n",
    "同様の回路を使い、回帰を行ってみます。QNN の場合と同様に、$\\sin(\\pi x)$ を学習します。まずデータセットを作ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_min = -1.0\n",
    "x_max = 1.0\n",
    "num_x = 1000\n",
    "x_train, y_train = generate_noisy_sine(x_min, x_max, num_x)\n",
    "x_test, y_test = generate_noisy_sine(x_min, x_max, num_x)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "学習します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.qsvm import QSVR\n",
    "n_qubit = 4                         # x_train の次元数以上必要。あまり小さいと結果が悪くなる。\n",
    "circuit = create_ibm_embedding_circuit(n_qubit)\n",
    "qsvm = QSVR(circuit)\n",
    "qsvm.fit(x_train, y_train)\n",
    "y_pred = qsvm.predict(x_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "学習結果をプロットしてみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(x_test, y_test, \"o\", label=\"Test\")\n",
    "plt.plot(np.sort(np.array(x_test).flatten()), np.array(y_pred)[np.argsort(np.array(x_test).flatten())], label=\"Prediction\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "うまく学習できています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 用意されている量子回路\n",
    "\n",
    "scikit-qulacs では代表的な論文で発表されている機械学習用量子回路を手軽に使えるようにするため、量子回路の実装に努めています。機械学習用量子回路は `LearningCircuit` クラスのインスタンスとして実装されていて、`skqulacs.circuit` モジュールにある `create_...()` という関数を呼ぶことにより作成可能です。\n",
    "\n",
    "代表的なansatzとして、\n",
    "- create_farhi_neven_ansatz(n_qubit: int, c_depth: int, seed: Optional[int] = None): [arXiv:1802.06002](https://arxiv.org/pdf/1802.06002)\n",
    "![farhi_neven_ansatz](figures/circuit_visualize/farhi_neven_ansatz.png)\n",
    "- create_ibm_embedding_circuit(n_qubit: int): [arXiv:1804.11326](https://arxiv.org/abs/1804.11326) \n",
    "![ibm_embedding_circuit](figures/circuit_visualize/ibm_embedding_circuit.png)\n",
    "\n",
    "が用意されています。\n",
    "\n",
    "他に利用可能な量子回路のリストについては[このページ](circuit_visualize.ipynb)をご覧ください。\n",
    "\n",
    "基本的には `QNNClassifier` などの引数として与えることを推奨しますが、自前で新たなアルゴリズムを作りたいときなど、これらの量子回路を直接扱いたいときもあると思います。以下に使用例を掲載します。\n",
    "\n",
    "以下のコードで QCL ansatz を作成します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_qubits = 4\n",
    "c_depth = 4\n",
    "time_step = 1.\n",
    "ansatz = create_qcl_ansatz(n_qubits, c_depth, time_step)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`LearningCircuit` にセットされている訓練パラメータは `get_parameters()` によって取り出せます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "48 [2.9646519753472966, 2.4054163630603496, 5.8984153363073375, 2.512801032804015, 5.964913519260788, 3.8936080016830195, 5.923572589632018, 4.9481732525951205, 1.568563629432675, 5.554018967676112, 0.028389796241806445, 2.897527605841249, 5.267355240624224, 3.735313799160573, 2.2661746616128897, 3.5452804132198086, 0.43246053635497056, 2.5730108963703193, 1.974663878510053, 1.9654655970918322, 3.967587987184092, 0.8120259125764905, 6.047592885353966, 0.5745413307337336, 0.9710274726615847, 0.4695106940105736, 2.341674095381348, 0.802699963876766, 0.8310916316734924, 5.012384620423008, 0.018233484756863608, 4.2472370241118345, 5.1721310224316355, 5.021016841850289, 3.1032612340282735, 6.090572550277523, 4.484895234385721, 2.0890853870812838, 1.8127693347262788, 3.7158089135425, 3.7028938225792483, 3.3726572966673407, 2.699611657167366, 1.6621937249934382, 1.1061035348895243, 1.5957931515488104, 0.26282289161037825, 2.4484720212561286]\n"
     ]
    }
   ],
   "source": [
    "parameters = ansatz.get_parameters()\n",
    "print(len(parameters), parameters)      # show parameters in the circuit. Parameters are chosen randomly within create_qcl_ansatz()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`update_parameters()` を使うと、パラメータを更新できます。以下では全てのパラメータをゼロにセットします。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n"
     ]
    }
   ],
   "source": [
    "ansatz.update_parameters(np.zeros(len(parameters)))\n",
    "print(ansatz.get_parameters())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`run(x)` を使うと、入力データ ${\\boldsymbol x}$ に対して、初期状態 $|0\\rangle$ に量子回路を作用させたときの出力状態が `qulacs.QuantumState` として返されます。QCL ansatz は `n_qubits` 次元までの入力を扱うことのできる ansatz なので、今回は 2 次元入力を与えます。\n",
    "\n",
    "多くの回路では、データ次元数をaとして、それが`n_qubits`以下の場合、回路のx番目には、n_qubits % a 番目の入力が入ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.30869612+0.13283004j -0.0759879 -0.06176279j -0.21316566-0.1438611j\n",
      "  0.21877642+0.06614673j -0.33638863+0.12504632j  0.24610584+0.23178805j\n",
      "  0.05948781+0.05711437j  0.03556247-0.08914448j  0.03556247-0.08914448j\n",
      "  0.05948781+0.05711437j  0.24610584+0.23178805j -0.33638863+0.12504632j\n",
      "  0.21877642+0.06614673j -0.21316566-0.1438611j  -0.0759879 -0.06176279j\n",
      "  0.30869612+0.13283004j]\n"
     ]
    }
   ],
   "source": [
    "state = ansatz.run([np.pi/2, np.pi/2])\n",
    "print(state.get_vector())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ユーザー定義の量子回路を学習に利用する\n",
    "ここでは自分でオリジナルの量子回路を定義し、それを学習に利用する方法を説明します。scikit-qulacs では、`LearningCircuit` クラスによって量子回路を表現しています。これは qulacs の `ParametricQuantumCircuit` のラッパーとなっていて、入力データと訓練される回路パラメータを一元管理し、それらをすべて qulacs の parametric gate で扱えるようにしたものです。\n",
    "\n",
    "`LearningCircuit` クラスは qulacs の `ParametricQuantumCircuit` のうちの主要な `add_.._gate()` 系のメソッドを機能そのままにラップしています。それに加えて、`ParametricQuantumCircuit` を拡張する機能として、以下のメソッドが追加されています。\n",
    "\n",
    "- `add_input_RX_gate(index, input_func)`, `add_input_RY_gate(index, input_func)`, `add_input_RZ_gate(index, input_func)`: 入力データを入れるためのゲートを追加します。引数にはそれぞれ以下のものを与えます。\n",
    "    - `index`: そのゲートを作用させる量子ビット\n",
    "    - `input_func`: 入力データ ${\\boldsymbol x}$ -> 回転ゲートの回転角 $\\phi = \\phi({\\boldsymbol x})$ の変換を行う関数。回路実行時には `input_func(x)` が角度にセットされます。\n",
    "- `add_parametric_input_RX_gate(index, parameter, input_func)` (RY, RZ も同様) :入力データと訓練パラメータが同時に含まれているようなゲートを追加します。\n",
    "    - `index`: そのゲートを作用させる量子ビット\n",
    "    - `parameter`: 実数の訓練パラメータ $\\theta$\n",
    "    - `input_func`: 入力データ ${\\boldsymbol x}$, 訓練パラメータ $\\theta$ -> 回転ゲートの回転角 $\\phi = \\phi(\\theta, {\\boldsymbol x})$ の変換を行う関数。回路実行時には `input_func(theta, x)` が角度にセットされます。\n",
    "\n",
    "例えば以下のコードは、各量子ビットに ${\\boldsymbol x} = \\{x_i\\}_{i=0}^3$ の各成分を $R_y$ ゲートで入力したあと、各量子ビットを訓練可能な $R_y$ ゲートで変換し、最後に全ての量子ビットにアダマールゲートを一度だけ作用させる `LearningCircuit` を構成するコードです。(例のためだけに書いていて、特に意味は無い回路です。) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.circuit import LearningCircuit\n",
    "n_qubit = 4\n",
    "circuit = LearningCircuit(n_qubit)\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_input_RY_gate(i, lambda x: x[i%2])  # input 2 dimensional x into the circuit by RY rotation\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_parametric_RY_gate(i, 0.)           # first argument is qubit index, second argument is parameter\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_H_gate(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`run()` メソッドによって初期状態 $|0\\rangle$ にこの回路を作用させたときの量子状態が返されます。このメソッドは入力データ ${\\boldsymbol x}$ を引数として取ります。上の回路は 2 次元の ${\\boldsymbol x}$ を取れるように設計したので、2次元の入力を与えます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-6.93889390e-18+0.j -1.96261557e-17+0.j -2.08166817e-17+0.j\n",
      " -2.77555756e-17+0.j -2.08166817e-17+0.j  1.96261557e-17+0.j\n",
      " -6.93889390e-18+0.j  0.00000000e+00+0.j -2.08166817e-17+0.j\n",
      "  1.96261557e-17+0.j -6.93889390e-18+0.j  2.77555756e-17+0.j\n",
      " -6.93889390e-18+0.j  5.88784672e-17+0.j  9.02056208e-17+0.j\n",
      "  1.00000000e+00+0.j]\n"
     ]
    }
   ],
   "source": [
    "x = [np.pi/2,np.pi/2]\n",
    "state = circuit.run(x)\n",
    "print(state.get_vector())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "予想どおりの出力が得られることが確認できます。"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "936c4c30906d6de6263fdbacaba83930bcd1a6edbdbdc3afaca24f66dfc3bc7e"
  },
  "kernelspec": {
   "display_name": "Python 3.9.12 ('.venv': poetry)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
