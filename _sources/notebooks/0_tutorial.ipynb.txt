{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# scikit-qulacs チュートリアル\n",
    "\n",
    "## scikit-qulacs とは \n",
    "\n",
    "量子回路シミュレータ [Qulacs-Osaka](https://github.com/Qulacs-Osaka/qulacs-osaka) ([Qulacs](https://github.com/qulacs/qulacs) の大阪大学バージョン) をバックエンドとした量子機械学習アルゴリズムのシミュレータです。scikit-learn の名前をもじっています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## インストール\n",
    "PyPI からインストールできます。\n",
    "```\n",
    "pip install skqulacs\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Quantum neural network\n",
    "入力データ ${\\boldsymbol x}$ に対して、学習パラメータ ${\\boldsymbol \\theta}$ を使って\n",
    "$$y_{{\\boldsymbol \\theta}}({\\boldsymbol x}) = \\langle 0|U^\\dagger({\\boldsymbol \\theta}, {\\boldsymbol x}) O U({\\boldsymbol \\theta}, {\\boldsymbol x})|0\\rangle$$\n",
    "の形でモデル $y_{{\\boldsymbol \\theta}}({\\boldsymbol x})$ を構築する手法を量子ニューラルネットワークと呼びます。scikit-qulacs では `skqulacs.qnn` モジュールに実装されています。分類問題をとく `skqulacs.qnn.classifier` と回帰問題を解く `skqulacs.qnn.regressor` の２つがあります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qnn.QNNClassifier` の使い方\n",
    "例として、有名な `iris` データセットを分類する量子ニューラルネットワークを組んでみます。まず、以下のコードによって `scikit-learn` から `iris` データセットを取り出し、訓練データとテストデータに分けます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from sklearn import datasets\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "iris = datasets.load_iris()\n",
    "df = pd.DataFrame(iris.data, columns=iris.feature_names)\n",
    "x = df.loc[:, [\"petal length (cm)\", \"petal width (cm)\"]]\n",
    "x_train, x_test, y_train, y_test = train_test_split(\n",
    "    x, iris.target, test_size=0.25, random_state=0\n",
    ")\n",
    "x_train = x_train.to_numpy()\n",
    "x_test = x_test.to_numpy()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "変数はそれぞれ\n",
    "- `x_train`: 訓練データの入力\n",
    "- `y_train`: 訓練データのラベル\n",
    "- `x_test`: テストデータの入力\n",
    "- `y_test`: テストデータのラベル\n",
    "\n",
    "です。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "次に簡単な量子回路によってこれらの分類を行ってみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trained parameters [ 1.85410272  3.75676148  2.21646191  2.52509231  2.1647195   2.43798985\n",
      "  1.50367222  0.04751448  2.54785017  2.13940606  4.98429799  4.14497582\n",
      "  5.47831644  4.83193472  1.52245352  4.56050188  2.51816388  1.40210201\n",
      "  3.95273519  1.34362204  0.89885804  4.01058809  2.8836804   1.50820136\n",
      "  5.51325943  0.47711481  3.44328084  3.65547664 -0.55173648  6.3383248\n",
      "  0.66032895  5.16735433 -1.04875626  6.14244395  6.99287629  1.31751974\n",
      "  0.19759514  4.00321349  3.90846605  1.9431826   0.53312599  3.28469292\n",
      "  6.0037434   4.20836194  1.83071748]\n",
      "loss 0.0860431460366711\n"
     ]
    }
   ],
   "source": [
    "from skqulacs.circuit.pre_defined import create_qcl_ansatz\n",
    "from skqulacs.qnn import QNNClassifier\n",
    "\n",
    "nqubit = 5                      # qubitの数。必要とする入力、出力の次元数以上が必要である。\n",
    "c_depth = 3                     # circuitの深さ。ニューラルネットワークでの隠れ層に対応する。\n",
    "time_step = 1.                  # qcl_ansatz に必要となるパラメータ。横磁場イジングモデルによって発展させる時間を決める。\n",
    "num_class = 3                   # 分類数（ここでは3つの品種に分類）\n",
    "solver=\"BFGS\"                   # アルゴリズム。ほかには、\"Adam\" が使える。\n",
    "maxiter = 20                    # ループの最大。これが多いほど、正確になるが、時間がかかる。\n",
    "circuit = create_qcl_ansatz(nqubit, c_depth, time_step)     # LearningCircuitを作る\n",
    "qcl = QNNClassifier(circuit, num_class, solver)     # モデル構築を行う\n",
    "opt_loss, opt_params = qcl.fit(x_train, y_train, maxiter)                          # 学習\n",
    "print(\"trained parameters\", opt_params)\n",
    "print(\"loss\", opt_loss)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "テストデータと比べて結果を出力します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.9473684210526315\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import f1_score\n",
    "y_pred = qcl.predict(x_test)\n",
    "print(f1_score(y_test, y_pred, average=\"weighted\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "うまく分類できていることがわかります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qnn.QNNRegressor` の使い方\n",
    "回帰問題を解くには `QNNRegressor` を使います。ここでは $y=\\sin(\\pi x)$ を学習させてみます。まずデータセットを作ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from numpy.random import default_rng\n",
    "\n",
    "def generate_noisy_sine(x_min, x_max, num_x):\n",
    "    rng = default_rng(0)\n",
    "    x_train = [[rng.uniform(x_min, x_max)] for _ in range(num_x)]\n",
    "    y_train = [np.sin(np.pi*x[0]) for x in x_train]\n",
    "    mag_noise = 0.01\n",
    "    y_train += mag_noise * rng.random(num_x)\n",
    "    return x_train, y_train\n",
    "  \n",
    "x_min = -1.0\n",
    "x_max = 1.0\n",
    "num_x = 80\n",
    "x_train, y_train = generate_noisy_sine(x_min, x_max, num_x)\n",
    "x_test, y_test = generate_noisy_sine(x_min, x_max, num_x)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "作成したデータに対して学習を行います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-2.52118172e-03  1.19277020e-03  3.10128326e-04 -6.42683364e-04\n",
      "  8.35436474e-04 -5.24981892e-04 -7.52008036e-04 -4.07462371e-04\n",
      " -5.74044155e-04  1.50774930e-03  6.30109294e-05 -8.19459615e-04\n",
      "  1.42078707e-03  2.09110696e-03 -3.36846534e-04  4.88690753e-04\n",
      "  7.46908451e-05 -2.22482857e-04 -9.25977438e-04 -9.12545452e-05\n",
      "  1.04324965e-03 -5.63038944e-04 -4.62934646e-04 -3.62787336e-04\n",
      " -8.51174859e-04  2.90978510e-03  1.96177705e-03  6.80510436e-05\n",
      "  1.69540322e-04  3.45813053e-04  3.20652348e-04 -2.24440888e-04\n",
      " -5.65850928e-05 -7.10191967e-04  5.10276819e-04  7.51022395e-04\n",
      "  1.50621087e-03 -1.01846464e-03 -8.74319743e-04  3.54710895e-17\n",
      "  3.59299055e-17  3.59218882e-17  3.58373194e-17  3.59945889e-17\n",
      "  3.55306677e-17  3.67906416e-17  3.59392206e-17  3.58473687e-17]\n",
      "trained parameters [ 4.76002724  1.92362022 -0.48900136  0.35047068  4.82948963  6.46225974\n",
      "  3.40609952  5.00474857  3.37636039  6.31050608  5.49376378  0.139052\n",
      "  5.47590209  0.64912218  4.67870237  1.41841969  5.53849844  3.7883166\n",
      "  1.84668854  2.68946397  0.04043366  0.96776472  4.49352776  3.60008095\n",
      "  3.88877639  2.58504726  6.23553393  6.16278554  4.24511007  3.92287119\n",
      "  4.33309344  2.56906654  0.6973149   4.8681623   3.38829756  1.61272237\n",
      "  3.30808541  5.46822145  5.94478902  2.24809352  3.59102784  2.02236503\n",
      "  3.73409722  2.12315885  2.46061475  5.59375873  1.42727325  3.91560031]\n",
      "loss 0.008518100629961275\n"
     ]
    }
   ],
   "source": [
    "from skqulacs.qnn import QNNRegressor\n",
    "\n",
    "n_qubit = 4\n",
    "depth = 4\n",
    "time_step = 0.5\n",
    "solver=\"BFGS\"\n",
    "maxiter=20\n",
    "circuit = create_qcl_ansatz(n_qubit, depth, time_step, 0)\n",
    "qnn = QNNRegressor(circuit, solver)\n",
    "opt_loss, opt_params = qnn.fit(x_train, y_train, maxiter)\n",
    "print(\"trained parameters\", opt_params)\n",
    "print(\"loss\", opt_loss)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "訓練したモデルとテストデータを並べてプロットしてみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "y_pred = qnn.predict(x_test)\n",
    "plt.plot(x_test, y_test, \"o\", label=\"Test\")\n",
    "plt.plot(np.sort(np.array(x_test).flatten()), np.array(y_pred)[np.argsort(np.array(x_test).flatten())], label=\"Prediction\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "よく学習できていることがわかります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 量子カーネル法\n",
    "入力データ ${\\boldsymbol x}$ を量子状態 $|\\psi({\\boldsymbol x})\\rangle$ にマップし、この量子状態間の内積で定義されるカーネル関数\n",
    "$$K({\\boldsymbol x},{\\boldsymbol x}')=|\\langle \\psi({\\boldsymbol x})| \\psi({\\boldsymbol x}')\\rangle|^2$$\n",
    "を使ったカーネル法を量子カーネル法と呼びます。scikit-qulacs には、support vector classifier `skqulacs.qsvm.QSVC` と support vector regressor `skqulacs.qsvm.QSVR` の2つが実装されています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qsvm.QSVC` の使い方\n",
    "ここでは IBM のグループが論文 [Supervised learning with quantum-enhanced feature spaces](https://www.nature.com/articles/s41586-019-0980-2) で提案した $|\\psi({\\boldsymbol x})\\rangle$ を使った分類を行います。この状態を作る量子回路は `skqulacs.circuit.create_ibm_embedding_circuit` によって作り出せます。\n",
    "\n",
    "まずデータセットを準備します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "iris = datasets.load_iris()\n",
    "df = pd.DataFrame(iris.data, columns=iris.feature_names)\n",
    "x = df.loc[:, [\"petal length (cm)\", \"petal width (cm)\"]]\n",
    "x_train, x_test, y_train, y_test = train_test_split(\n",
    "    x, iris.target, test_size=0.25, random_state=0\n",
    ")\n",
    "x_train = x_train.to_numpy()\n",
    "x_test = x_test.to_numpy()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "回路を作成し、QSVC を訓練、予測値を出力させます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.circuit import create_ibm_embedding_circuit\n",
    "from skqulacs.qsvm import QSVC\n",
    "n_qubit = 4                         # x_train の次元数以上必要。あまり小さいと結果が悪くなる。\n",
    "circuit = create_ibm_embedding_circuit(n_qubit)\n",
    "qsvm = QSVC(circuit)\n",
    "qsvm.fit(x_train, y_train)\n",
    "y_pred = qsvm.predict(x_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "評価してみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.8978070175438595\n"
     ]
    }
   ],
   "source": [
    "print(f1_score(y_test, y_pred, average=\"weighted\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "qnn よりも悪い結果となりました。回路形がこのデータセットに適していないからだと考えられます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### `skqulacs.qsvm.QSVR` の使い方\n",
    "同様の回路を使い、回帰を行ってみます。QNN の場合と同様に、$\\sin(\\pi x)$ を学習します。まずデータセットを作ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_min = -1.0\n",
    "x_max = 1.0\n",
    "num_x = 1000\n",
    "x_train, y_train = generate_noisy_sine(x_min, x_max, num_x)\n",
    "x_test, y_test = generate_noisy_sine(x_min, x_max, num_x)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "学習します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.qsvm import QSVR\n",
    "n_qubit = 4                         # x_train の次元数以上必要。あまり小さいと結果が悪くなる。\n",
    "circuit = create_ibm_embedding_circuit(n_qubit)\n",
    "qsvm = QSVR(circuit)\n",
    "qsvm.fit(x_train, y_train)\n",
    "y_pred = qsvm.predict(x_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "学習結果をプロットしてみます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(x_test, y_test, \"o\", label=\"Test\")\n",
    "plt.plot(np.sort(np.array(x_test).flatten()), np.array(y_pred)[np.argsort(np.array(x_test).flatten())], label=\"Prediction\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "うまく学習できています。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 用意されている量子回路\n",
    "\n",
    "scikit-qulacs では代表的な論文で発表されている機械学習用量子回路を手軽に使えるようにするため、量子回路の実装に努めています。機械学習用量子回路は `LearningCircuit` クラスのインスタンスとして実装されていて、`skqulacs.circuit` モジュールにある `create_...()` という関数を呼ぶことにより作成可能です。\n",
    "\n",
    "代表的なansatzとして、\n",
    "- create_farhi_neven_ansatz(n_qubit: int, c_depth: int, seed: Optional[int] = None): [arXiv:1802.06002](https://arxiv.org/pdf/1802.06002)\n",
    "![farhi_neven_ansatz](figures/circuit_visualize/farhi_neven_ansatz.png)\n",
    "- create_ibm_embedding_circuit(n_qubit: int): [arXiv:1804.11326](https://arxiv.org/abs/1804.11326) \n",
    "![ibm_embedding_circuit](figures/circuit_visualize/ibm_embedding_circuit.png)\n",
    "\n",
    "が用意されています。\n",
    "\n",
    "他に利用可能な量子回路のリストについては[このページ](circuit_visualize.ipynb)をご覧ください。\n",
    "\n",
    "基本的には `QNNClassifier` などの引数として与えることを推奨しますが、自前で新たなアルゴリズムを作りたいときなど、これらの量子回路を直接扱いたいときもあると思います。以下に使用例を掲載します。\n",
    "\n",
    "以下のコードで QCL ansatz を作成します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_qubits = 4\n",
    "c_depth = 4\n",
    "time_step = 1.\n",
    "ansatz = create_qcl_ansatz(n_qubits, c_depth, time_step)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`LearningCircuit` にセットされている訓練パラメータは `get_parameters()` によって取り出せます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "48 [0.7238575654756965, 4.521772018945494, 5.300166829620294, 2.4396786706992875, 3.372497641445515, 0.0691143830945458, 2.4305919508432194, 0.897581496914585, 0.8153164989629146, 4.19580716083789, 4.614797622397918, 2.951713965321396, 2.449149087341643, 2.4619419636304105, 1.0029754525418129, 2.334478387370933, 2.5589036813723762, 4.50591651911791, 4.486222509952132, 1.559585289816079, 6.164351024607971, 1.47322926380012, 2.0729721326039914, 2.275646680431729, 2.9195023453638385, 2.7015553984398526, 5.814853292230643, 5.161654841481886, 0.7527848104233957, 1.728308187107492, 5.360006969176836, 5.201498343709625, 0.42675480228093243, 1.967788806417369, 1.7897854085117577, 5.321631318940725, 5.6122834079775785, 5.437876706508988, 2.4878547042811134, 3.796733572414534, 0.9677624343101473, 1.8208670050419042, 0.4657427370080585, 5.820313505901443, 1.2863802672251754, 2.4653914032427604, 0.3882421258541333, 1.4073421893586033]\n"
     ]
    }
   ],
   "source": [
    "parameters = ansatz.get_parameters()\n",
    "print(len(parameters), parameters)      # show parameters in the circuit. Parameters are chosen randomly within create_qcl_ansatz()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`update_parameters()` を使うと、パラメータを更新できます。以下では全てのパラメータをゼロにセットします。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n"
     ]
    }
   ],
   "source": [
    "ansatz.update_parameters(np.zeros(len(parameters)))\n",
    "print(ansatz.get_parameters())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`run(x)` を使うと、入力データ ${\\boldsymbol x}$ に対して、初期状態 $|0\\rangle$ に量子回路を作用させたときの出力状態が `qulacs.QuantumState` として返されます。QCL ansatz は `n_qubits` 次元までの入力を扱うことのできる ansatz なので、今回は 2 次元入力を与えます。\n",
    "\n",
    "多くの回路では、データ次元数をaとして、それが`n_qubits`以下の場合、回路のx番目には、n_qubits % a 番目の入力が入ります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 0.30869612+0.13283004j -0.0759879 -0.06176279j -0.21316566-0.1438611j\n",
      "  0.21877642+0.06614673j -0.33638863+0.12504632j  0.24610584+0.23178805j\n",
      "  0.05948781+0.05711437j  0.03556247-0.08914448j  0.03556247-0.08914448j\n",
      "  0.05948781+0.05711437j  0.24610584+0.23178805j -0.33638863+0.12504632j\n",
      "  0.21877642+0.06614673j -0.21316566-0.1438611j  -0.0759879 -0.06176279j\n",
      "  0.30869612+0.13283004j]\n"
     ]
    }
   ],
   "source": [
    "state = ansatz.run([np.pi/2, np.pi/2])\n",
    "print(state.get_vector())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ユーザー定義の量子回路を学習に利用する\n",
    "ここでは自分でオリジナルの量子回路を定義し、それを学習に利用する方法を説明します。scikit-qulacs では、`LearningCircuit` クラスによって量子回路を表現しています。これは qulacs の `ParametricQuantumCircuit` のラッパーとなっていて、入力データと訓練される回路パラメータを一元管理し、それらをすべて qulacs の parametric gate で扱えるようにしたものです。\n",
    "\n",
    "`LearningCircuit` クラスは qulacs の `ParametricQuantumCircuit` のうちの主要な `add_.._gate()` 系のメソッドを機能そのままにラップしています。それに加えて、`ParametricQuantumCircuit` を拡張する機能として、以下のメソッドが追加されています。\n",
    "\n",
    "- `add_input_RX_gate(index, input_func)`, `add_input_RY_gate(index, input_func)`, `add_input_RZ_gate(index, input_func)`: 入力データを入れるためのゲートを追加します。引数にはそれぞれ以下のものを与えます。\n",
    "    - `index`: そのゲートを作用させる量子ビット\n",
    "    - `input_func`: 入力データ ${\\boldsymbol x}$ -> 回転ゲートの回転角 $\\phi = \\phi({\\boldsymbol x})$ の変換を行う関数。回路実行時には `input_func(x)` が角度にセットされます。\n",
    "- `add_parametric_input_RX_gate(index, parameter, input_func)` (RY, RZ も同様) :入力データと訓練パラメータが同時に含まれているようなゲートを追加します。\n",
    "    - `index`: そのゲートを作用させる量子ビット\n",
    "    - `parameter`: 実数の訓練パラメータ $\\theta$\n",
    "    - `input_func`: 入力データ ${\\boldsymbol x}$, 訓練パラメータ $\\theta$ -> 回転ゲートの回転角 $\\phi = \\phi(\\theta, {\\boldsymbol x})$ の変換を行う関数。回路実行時には `input_func(theta, x)` が角度にセットされます。\n",
    "\n",
    "例えば以下のコードは、各量子ビットに ${\\boldsymbol x} = \\{x_i\\}_{i=0}^3$ の各成分を $R_y$ ゲートで入力したあと、各量子ビットを訓練可能な $R_y$ ゲートで変換し、最後に全ての量子ビットにアダマールゲートを一度だけ作用させる `LearningCircuit` を構成するコードです。(例のためだけに書いていて、特に意味は無い回路です。) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "from skqulacs.circuit import LearningCircuit\n",
    "n_qubit = 4\n",
    "circuit = LearningCircuit(n_qubit)\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_input_RY_gate(i, lambda x: x[i%2])  # input 2 dimensional x into the circuit by RY rotation\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_parametric_RY_gate(i, 0.)           # first argument is qubit index, second argument is parameter\n",
    "for i in range(n_qubit):\n",
    "    circuit.add_H_gate(i)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "`run()` メソッドによって初期状態 $|0\\rangle$ にこの回路を作用させたときの量子状態が返されます。このメソッドは入力データ ${\\boldsymbol x}$ を引数として取ります。上の回路は 2 次元の ${\\boldsymbol x}$ を取れるように設計したので、2次元の入力を与えます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-6.93889390e-18+0.j -1.96261557e-17+0.j -2.08166817e-17+0.j\n",
      " -2.77555756e-17+0.j -2.08166817e-17+0.j  1.96261557e-17+0.j\n",
      " -6.93889390e-18+0.j  0.00000000e+00+0.j -2.08166817e-17+0.j\n",
      "  1.96261557e-17+0.j -6.93889390e-18+0.j  2.77555756e-17+0.j\n",
      " -6.93889390e-18+0.j  5.88784672e-17+0.j  9.02056208e-17+0.j\n",
      "  1.00000000e+00+0.j]\n"
     ]
    }
   ],
   "source": [
    "x = [np.pi/2,np.pi/2]\n",
    "state = circuit.run(x)\n",
    "print(state.get_vector())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "予想どおりの出力が得られることが確認できます。"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "9a254056ba7bb2d506825dd7a222ffa8b49c259e89497b09ec821585fc31e38d"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
